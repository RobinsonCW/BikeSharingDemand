---
title: "Exploratory_Data_Analysis"
author: "Chance Robinson"
date: "9/21/2019"
output: 
  github_document:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Exploratory Data Analysis


### Library Imports

```{r libraries, quietely=TRUE, warn.conflicts=FALSE}
library(tidyverse)
library(lubridate)

```

### Load the csv data


```{r load, results='hide', message=FALSE}

train <- read_csv('../../data/train.csv')
test <- read_csv('../../data/test.csv')

```

### Column Names (Train)

```{r column_names}

colnames(train)

```

### Example Output (Train)

```{r}

head(train)

```


### Example Output (Train)

```{r train}

head(train)

```

### Example output (Test)

- The test data set is missing 3 columns from the train data set (causal, registered and count)

```{r test}

head(test)

```

### Identify Dimensions

```{r echo=FALSE}
# get the dimensions of the train and test data sets

no_of_rows_trn <- dim(train)[1]
no_of_rows_tst <- dim(test)[1]

no_of_cols_trn <- dim(train)[2]
no_of_cols_tst <- dim(test)[2]

# no_of_rows_trn
# no_of_rows_tst
# 
# no_of_cols_trn
# no_of_cols_tst

```

- Train {"rows": `r no_of_rows_trn`, "columns": `r no_of_cols_trn`}

- Test {"rows": `r no_of_rows_tst`, "columns": `r no_of_cols_tst`}


### Missing Data (Both)

- No NA values can be found in either the training or test data sets 

```{r missing}

# train
any(is.na(train))

# test
any(is.na(test))

```


### Data Dictionary

  Column Name      | 	Type                Description
  -----------------|    ----------------- | ------------------------------------------------
  1.  datetime     |    Date			        | YYYY-MM-DD HH24 (example:  2011-01-01 04:00:00)
  2.  season       |    Integer 		      |	(1-4)
  3.  holiday      |    Integer 		      |	(0 or 1)
  4.  workingday   |    Integer 		      |	(0 or 1)
  5.  weather      |    Integer 		      |	(1-4)
  6.  temp         |    Float 			      |	temparture in Celcius
  7.  atemp        |    Float 			      |	"feels like" temperature in Celsius
  8.  humidity     |    Integer           | relative humidity
  9.  windspeed    |    Float             | wind speed
  10. casual       |    Integer 		      |	count of casual users 
  11. registered   |    Integer 		      |	count of registered users 
  12. count        |    Integer 		      |	count of total users `response variable`
  
  
### Factors

  * season
    + 1 = Dec 21 ~ March 20 (Spring)
    + 2 = March 21 ~ Jun 20 (Summer)
    + 3 = June 21 ~ Sept 20 (Fall)
    + 4 = Sept 21 ~ Dec 20  (Winter)

  * holiday
    + 0 = No
    + 1 = Yes
    
  * workingday
    + 0 = No
    + 1 = Yes
    
```{r factors}
train$season <- factor(train$season, labels = c("Spring", "Summer", "Fall", "Winter"))
test$season <- factor(test$season, labels = c("Spring", "Summer", "Fall", "Winter"))

table(train$season)

train$holiday <- factor(train$holiday, labels = c("No", "Yes"))
test$holiday <- factor(test$holiday, labels = c("No", "Yes"))

table(test$holiday)

train$workingday <- factor(train$workingday, labels = c("No", "Yes"))
test$workingday <- factor(test$workingday, labels = c("No", "Yes"))


train$weather <- factor(train$weather, labels = c("Great", "Good", "Average", "Poor"))
test$weather <- factor(test$weather, labels = c("Great", "Good", "Average", "Poor"))


table(test$weather)


```



### Split Date-Time (Both)

- Year, Month, Day and Hour

```{r}
library(lubridate)



train <- train %>%
  mutate(year = as.numeric(format(datetime, format = "%Y")), 
         month = as.numeric(format(datetime, format = "%m")), 
         day = as.numeric(format(datetime, format = "%d")),
         hour = as.numeric(format(datetime, format = "%H")))

test <- test %>%
  mutate(year = as.numeric(format(datetime, format = "%Y")), 
         month = as.numeric(format(datetime, format = "%m")), 
         day = as.numeric(format(datetime, format = "%d")),
         hour = as.numeric(format(datetime, format = "%H")))





```



### Convert Months to Ordered Factor (Both)

```{r}

train$month <-month(train$datetime, label = TRUE, abbr = FALSE)
test$month <-month(test$datetime, label = TRUE, abbr = FALSE)

```


### Count by Month (Train)

- The months seem to show an upward trend throughout the year
- Increased popularity of Ride-Sharing program?

```{r}

train %>%
  ggplot(aes(x = month)) + 
  geom_bar() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))

```

### Count by Month (Test)

- Notice how the months with fewer days have fewer totals (i.e...February)


```{r}

test %>%
  ggplot(aes(x = month)) + 
  geom_bar() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))

```




### Days (Train)

- The train data set covers days from the 1st through the 19th


```{r}

train %>%
  ggplot(aes(x = day)) + 
  geom_bar()

```


### Days (Test)

- The test set covers days from the 20th through the 31st

```{r days_test}


test %>%
  ggplot(aes(x = day)) + 
  geom_bar()


```

```{r}
head(train)
```


### Explanatory Variable plots against Response Variable

```{r}

train %>%
  ggplot(aes(x=season, y=count, fill=season)) + geom_boxplot()


train %>%
  ggplot(aes(x=holiday, y=count, fill=holiday)) + geom_boxplot()


train %>%
  ggplot(aes(x=workingday, y=count, fill=workingday)) + geom_boxplot()


train %>%
  ggplot(aes(x=weather, y=count, fill=weather)) + geom_boxplot()

```



### Model Fitting


```{r}

model.base.formula = count ~ season + 
                             holiday +
                             workingday + 
                             weather + 
                             windspeed


model  <- lm(formula = model.base.formula, data = train)

plot(model)

```

